!function(i){"use strict";const c=function(){const l=new WeakMap;function o(o,e,t){l.set(this,{type:e?"embed":"popup",$parent:e||i("body"),$container:null,$element:null,selectedColor:o||null,colors:[],callback:t||null,offset:{top:0,left:0}}),this._init()}return o.prototype={_init:function(){var o=l.get(this);this._buildColors(),this._buildDOM(),this._bind(),this._selectColor(o.selectedColor)},_buildDOM:function(){const o=l.get(this);var e='<div><div id="folders-colorpicker-saved-colors" class="folders-colorpicker-colors">'+this._renderSavedColors()+'</div><div class="folders-colorpicker-line"></div><div class="folders-colorpicker-colors">'+this._renderMainColors()+'</div><div class="folders-colorpicker-line"></div><div class="folders-colorpicker-row"><div class="folders-colorpicker-input-text-wrap"><input class="folders-colorpicker-input-text" type="text" maxlength="7"><i class="folders-colorpicker-clear">&times;</i></div><div class="folders-colorpicker-input-color-wrap"><input class="folders-colorpicker-input-color" type="color" value="#ffffff"><div class="folders-colorpicker-preview-wrap"><div class="folders-colorpicker-preview"></div></div></div><div class="folders-colorpicker-button folders-colorpicker-button-submit">OK</div></div></div>';o.$container=i(e).toggleClass("folders-colorpicker-embed","embed"==o.type).toggleClass("folders-colorpicker-popup","popup"==o.type),o.$parent.append(o.$container)},_bind:function(){const o=l.get(this);o.$container.on("click",".folders-colorpicker-colors .folders-colorpicker-color",this._clickColor.bind(this)),o.$container.on("dblclick",".folders-colorpicker-colors .folders-colorpicker-color",this._dblclickColor.bind(this)),o.$container.on("click",".folders-colorpicker-clear",this._clearColor.bind(this)),o.$container.on("click",".folders-colorpicker-button-submit",this._submit.bind(this)),o.$container.find(".folders-colorpicker-input-text").on("input",this._setColorFromInput.bind(this)),o.$container.find(".folders-colorpicker-input-color").on("input",this._setColorFromPreview.bind(this)),i(window).on("resize",this._resize.bind(this)),document.addEventListener("mousedown",this._mousedown.bind(this),{capture:!0})},_renderMainColors:function(){var e=l.get(this);let t="";for(let o=0;o<3;o++){t+='<div class="folders-colorpicker-row">';for(const i of e.colors[o])t+='<div class="folders-colorpicker-color" data-color="'+i+'" style="background-color:'+i+'"></div>';t+="</div>"}return t},_renderSavedColors:function(){var o=l.get(this),e=Cookies.get("folders-colorpicker-colors")?JSON.parse(Cookies.get("folders-colorpicker-colors")):[null,null,null,null,null];let t="";t+='<div class="folders-colorpicker-row"><div class="folders-colorpicker-color folders-colorpicker-color-save" title="add to pallete"></div>';for(const c in o.colors[3]){var i=e[c]||o.colors[3][c];t+='<div class="folders-colorpicker-color" data-color="'+i+'" style="background-color:'+i+'"></div>'}return t+="</div>"},_buildColors:function(){const o=l.get(this);o.colors.push(["#e49086","#f2b78f","#fde7ab","#cddf7b","#8fcaf2","#db96d9"]),o.colors.push(["#d35141","#e98746","#fbd25e","#b3cf3c","#46a8e9","#c65bbb"]),o.colors.push(["#aa2b22","#c85f19","#fabc0f","#819526","#1981c8","#9d3aa7"]),o.colors.push(["#000000","#222222","#444444","#666666","#888888"])},_show:function(o){const e=l.get(this);e.$element=i(o.currentTarget),this._place(e.$element),this._selectColor(this.get(e.$element)),e.$container.find("#folders-colorpicker-saved-colors").empty().append(this._renderSavedColors()),e.$container.addClass("folders-active")},_close:function(){const o=l.get(this);o.$element=null,o.$container.removeClass("folders-active")},_mousedown:function(o){const e=l.get(this);!e.$element||e.$element.is(o.target)||e.$container.is(o.target)||e.$container.find(o.target).length||this._close()},_place:function(o){const e=l.get(this);var t=document.documentElement,i=(window.scrollX||t.scrollLeft)-(t.clientLeft||0),t=(window.scrollY||t.scrollTop)-(t.clientTop||0),c=o.offset(),r=c.top-t,c=c.left-i;t=o.outerHeight(!1),e.$container.css({top:r+e.offset.top+t,left:c+e.offset.left})},_resize:function(){var o=l.get(this);o.$element&&this._place(o.$element)},_selectColor:function(o){const e=l.get(this);o&&0!=o.length?(e.selectedColor=o,i(".folders-colorpicker-input-text",e.$container).val(o),i(".folders-colorpicker-input-color",e.$container).val(o),i(".folders-colorpicker-preview",e.$container).css({background:o||""})):(e.selectedColor=null,i(".folders-colorpicker-input-text",e.$container).val(""),i(".folders-colorpicker-input-color",e.$container).val("#ffffff"),i(".folders-colorpicker-preview",e.$container).css({background:""}))},_clearColor:function(){this._selectColor()},_saveColor:function(){const o=l.get(this);if(o.selectedColor){const e=Cookies.get("folders-colorpicker-colors")?JSON.parse(Cookies.get("folders-colorpicker-colors")):[null,null,null,null,null,null];if(e[0]!==o.selectedColor){for(let o=e.length-1;0<o;o--)e[o]=e[o-1];e[0]=o.selectedColor,Cookies.set("folders-colorpicker-colors",JSON.stringify(e))}o.$container.find("#folders-colorpicker-saved-colors").html(this._renderSavedColors())}},_clickColor:function(o){const e=i(o.currentTarget);e.hasClass("folders-colorpicker-color-save")?this._saveColor():this._selectColor(i(o.currentTarget).attr("data-color"))},_dblclickColor:function(o){const e=i(o.currentTarget);e.hasClass("folders-colorpicker-color-save")||(this._selectColor(i(o.currentTarget).attr("data-color")),this._submit())},_setColorFromInput:function(o){const e=l.get(this);e.selectedColor=i(".folders-colorpicker-input-text",e.$container).val(),"#"!=e.selectedColor[0]&&(e.selectedColor="#"+e.selectedColor,i(".folders-colorpicker-input-text",e.$container).val(e.selectedColor)),0<e.selectedColor.length?(i(".folders-colorpicker-input-color",e.$container).val(e.selectedColor),i(".folders-colorpicker-preview",e.$container).css({background:e.selectedColor||""})):(i(".folders-colorpicker-input-color",e.$container).val("#fff"),i(".folders-colorpicker-preview",e.$container).css({background:""}))},_setColorFromPreview:function(o){this._selectColor(o.target.value)},_submit:function(){const o=l.get(this);o.$element?o.$element.attr({"data-color":o.selectedColor}).css({background:o.selectedColor||""}).trigger("color",o.selectedColor):o.callback&&"function"==typeof o.callback&&o.callback.call(null,o.selectedColor),this._close()},set:function(o,e,t){const i=l.get(this);i.offset.top=t&&t.top?t.top:0,i.offset.left=t&&t.left?t.left:0,o.data("colorpicker")||o.on("click",this._show.bind(this)),o.data({colorpicker:!0}).attr({"data-color":e||null}).css({background:e||""})},get:function(o){if(o.data("colorpicker")){const e=o.attr("data-color");return e?e.toUpperCase():null}return null}},o}();window.IFOLDERS=window.IFOLDERS||{},window.IFOLDERS.PLUGINS=window.IFOLDERS.PLUGINS||{},window.IFOLDERS.PLUGINS.COLORPICKER=function(o,e,t){return new c(o,e,t)}}(jQuery);